<html>
<!--Page generated by REBOL-->
<head>
<title>Validation Proposal</title>
<style type="text/css">
html, body, p, td, li {font-family: arial, sans-serif, helvetica; font-size: 10pt;}
h1 {font-size: 16pt; Font-Weight: bold;}
h2 {font-size: 14pt; color: #2030a0; Font-Weight: bold; width: 100%;
    border-bottom: 1px solid #c09060;}
h3 {font-size: 12pt; color: #2030a0; Font-Weight: bold;}
h4 {font-size: 10pt; color: #2030a0; Font-Weight: bold;}
h5 {font-size: 10pt; Font-Weight: bold;}
tt {font-family: "courier new", monospace, courier; color: darkgreen;}
pre {font: bold 10pt "courier new", monospace, console;
    background-color: #e0e0e0; padding: 16px; border: solid #a0a0a0 1px;}
.toc1 {margin-left: 1cm; font-size: 12pt; font-weight: bold;}
.toc2 {margin-left: 2cm; font-size: 10pt; Font-Weight: bold; text-decoration: none;}
.toc3 {margin-left: 3cm; font-size: 10pt; text-decoration: none;}
.toc4 {margin-left: 4cm; font-size: 10pt; color: grey; text-decoration: none;}
.output {color: #000080; font-weight: normal;}
.note {background-color: #f0e090; width: 100%; padding: 16px; border: solid #a0a0a0 1px;}
.tail {color: gray; font-size: 8pt;}
</style>
</head>
<body bgcolor="white">
<table width="660" cellpadding="4" cellspacing="0" border="0">
<tr>
<td><a href="http://www.rebol.com"><img src="http://www.rebol.net/graphics/reb-bare.jpg"
    border=0 alt="REBOL"></a></td>
</tr>
<tr height="10"><td></td></tr>
<tr><td><h1>Validation Proposal</h1>
<blockquote><b>
Author: Henrik Mikael Kristensen<br>Date: 25-May-2010
</b></blockquote>
<h2>Contents:</h2>
<a class="toc1" href="#section-1">1. Rationale</a><br>
<a class="toc1" href="#section-2">2. Ideas</a><br>
<a class="toc2" href="#section-2.1">2.1 VALIDATE-FACE</a><br>
<a class="toc2" href="#section-2.2">2.2 Validation indication</a><br>
<a class="toc2" href="#section-2.3">2.3 Validation states</a><br>
<a class="toc2" href="#section-2.4">2.4 Validation modes</a><br>
<a class="toc2" href="#section-2.5">2.5 When to validate</a><br>
<a class="toc1" href="#section-3">3. Source examples</a><br>
<a class="toc1" href="#section-4">4. Notes</a><br>
<h2 id="section-1">1. Rationale</h2>
<blockquote>
<p>The R3-GUI needs a way to validate forms. Form validation is trivial and time consuming work to implement, so it will be nice to have as a standard feature in the R3-GUI.</p>
</blockquote>
<h2 id="section-2">2. Ideas</h2>
<blockquote>
</blockquote>
<h3 id="section-2.1">2.1 VALIDATE-FACE</h3>
<blockquote>
<ol>
<li>validation occurs through a single function: VALIDATE-FACE <face> and is recursive, can be done on window level or face level.</li>
<li>validation of single faces with an INPUT tag</li>
<li>validation of panels of faces with INPUT tags</li>
</ol>
</blockquote>
<h3 id="section-2.2">2.2 Validation indication</h3>
<blockquote>
<ol>
<li>validation indicator icon that would have to reside to the right of the face that needs to be validated. this is a bit informal to do it like that, but the setup is common and would be flexible enough to use both on single faces and entire panels.</li>
<li>validation indicator is not obligatory to attach to a face</li>
<li>method for triggering validation for a single face. not sure a reactor is useful. result of validation is logic! where true is 'valid</li>
</ol>
</blockquote>
<h3 id="section-2.3">2.3 Validation states</h3>
<blockquote>
<ol>
<li>indicator states: 'not-required, 'required, 'valid, 'invalid</li>
<li>'required means that when validation fails, this is a fatal error</li>
<li>'not-required means that when validation fails, this is not a fatal error</li>
<li>keyword for indication of  'required field in layout</li>
<li>turn off validation on disabled faces</li>
</ol>
</blockquote>
<h3 id="section-2.4">2.4 Validation modes</h3>
<blockquote>
<table cellspacing="6" border="0" width="95%">
<tr><td width="20">&nbsp;</td><td valign="top" width="80"><b>init</b></td><td valign="top">sets all valid-indicators to initial state: 'valid, 'required or 'not-required, would be appropriate for reopened filled forms and cleared new forms
</td></tr>
<tr><td width="20">&nbsp;</td><td valign="top" width="80"><b>preliminary</b></td><td valign="top">performs validation, but doesn't show result - useful for when validation is required dyring typing in form
</td></tr>
<tr><td width="20">&nbsp;</td><td valign="top" width="80"><b>submission</b></td><td valign="top">validate and show all results and auto-focus first invalid field - useful on final validation when wanting to submit
</td></tr>
</table>
<ol>
<li>state transition on init: valid -> valid, invalid -> required, not-required -> not-required, required -> required</li>
<li>state transition on validate: not-required -> valid, required -> valid or invalid, valid -> valid, invalid -> invalid</li>
</ol>
</blockquote>
<h3 id="section-2.5">2.5 When to validate</h3>
<blockquote>
<ol>
<li>initial validation on window open. this would work both for new forms and already filled forms as indicated by the state transition above.</li>
<li>submission validation on window submission-close, when clicking a submit button</li>
<li>clear validation result on window cancel-close, when clicking a cancel button</li>
<li>sum of validation for entire form returns logic!</li>
<li>need a VALIDATION word in each face that needs validation. it holds the state words: 'not-required, 'required, 'valid, 'invalid or NONE, if the face is not to be validated at all.</li>
<li>function to collect a list of faces that are invalid by traversing the GUI for the VALIDATION word. name is TBD.</li>
<li>buttons that perform validation, such as a window submit button.</li>
</ol>
</blockquote>
<h2 id="section-3">3. Source examples</h2>
<blockquote>
<p>This would validate the field, when clicking the button:</p>
<pre>
view [
    f: field validate [not empty? get-face face] valid-indicator
    button "Validate" do [validate-face f]
]
</pre>
</blockquote>
<h2 id="section-4">4. Notes</h2>
<blockquote>
<p>If this is done right, the only code the user needs to write is the code to validate the field, and otherwise place indicators and a submit button. The GUI handles the rest.</p>
<p>I wouldn't want to provide standard validation code through keywords. The issue is that this splits the implementation in a need for custom validation and one that follows standard keywords and that's too messy.</p>
<p>It's possible that we need to rework it to fit better with the philosophy of how to attach meta-information to a layout stated in the db-reactors.r3 file.</p>
<p>I know this validation scheme is possible, because I've already implemented around 75% of it in the VID Extension Kit.</p>
</blockquote>
</td></tr><tr>
<tr><td><img src="http://www.rebol.net/graphics/reb-tail.jpg" border=0></td></tr>
<td align="center">
<span class="tail"><a href="http://www.rebol.com">MakeDoc2 by REBOL</a> - 25-May-2010</span>
</td></tr></table>
</body></html>
