<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">@media screen { h1,h2,h3,h4,h5,p,a,br,li,td, .underline {font-family:Arial, Helvetica, sans-serif;text-align:justify} body {font-size:11pt;line-height:1.3em} h1 {font-size:18pt} h2 {font-size:15pt} h3 {font-size:13pt} h4 {font-size:12pt} h5 {font-size:11pt} hr {text-align:center;height:1px;border:none;background:black} ol,ul,p,table {margin-left:3em;margin-right:3em} a {text-decoration:none} a:hover {text-decoration:underline} img {} .defword {width:25%} .defexplain {} .defexplain p {padding:0em;margin:0em} .deftablepara {} .deftable {width:85%;padding-left:1em;border-style:none;vertical-align:top} .deftable td {text-align:left;vertical-align:top} .deftablefaq {border-style:solid;border-width:thin} .stdtable {border:1px solid;background:black} .stdtable th {padding:0.5em;background:#EEEEEE;font-family:Arial, Helvetica, sans-serif;font-weight:bold;text-align:center} .stdtable td {padding:0.5em;background:white;text-align:left;vertical-align:top} .end {font-size:8pt} .example {margin-left:3em;margin-right:3em;border:1px solid;padding:1em;background-color:#EEEEEE} .header {margin-left:3em;margin-right:3em;border:1px solid;padding:1em;background-color:#FFFFEE} .indented {margin-left: 50px} .litable {text-align:left} .new {border-right:10px solid;padding-right:10px;font-family:Arial} .note {margin:0.5em 3em 0.5em 3em;border:1px solid;padding:0em;background-color:#F0F0A0} .note .title {font-family:sans-serif;font-weight:bold;margin:0.5em} .note .message {margin:0.5em 1.5em 0.5em 1.5em;padding:0em} .note .message p {padding:0em;margin:1em 0em 1em 0em} .reference {} .caption {font-size:10pt;text-align:center;font-style:italic} .todolist {padding:0.5em;font-size:10pt} .todolist p {margin:0em 3em 0em 3em} .todo {margin:1em 3em 1em 3em;padding:0.5em;border:solid 2px black;background:#FFAAAA;font-size:10pt} .todo p {margin:0.2em 1em 0.2em 1em} .inline {margin:0.5em 3em 0.5em 3em;border:solid 1px;padding:0em;background-color:#EEEEEE} .inline .title {font-family:sans-serif;font-weight:bold;margin:0.5em} .inline .elements {font-size:10pt;margin:0em 0em 0.5em 0em;padding:0em 1em 0em 1em} .inline .elements p {display:inline-table;margin:0.25em 0.5em 0.25em 0.5em} .tocindent {margin-left: 2em} .top {font-size:8pt;text-align:right} .underline {text-decoration:underline} } @media print { h1,h2,h3,h4,h5,p,a,br,li, #underline {font-family:Arial;text-align:justify;orphans:5;widows:5} p,li,td {font-size:10pt} ul,ol {page-break-after:avoid;orphans:5;widows:5} }</style><title>R3 GUI / TEXT-TABLE</title></head><body onload="window.location.hash = window.location.hash"><a id="top" name="top"></a><h2>R3 GUI / TEXT-TABLE</h2><pre class="header"><strong>Author: Boleslav Březovský
Type: User Documentation
Date: 7-Nov-2011</strong></pre><hr /><h2>Contents</h2><div class="tocindent"><a href="#sect1"><strong>1. Dialect specification</strong></a><br /><div class="tocindent"><a href="#sect1.1"><strong>1.1 init-size</strong></a><br /><a href="#sect1.2"><strong>1.2 list-options</strong></a><br /><a href="#sect1.3"><strong>1.3 list-data</strong></a><br /></div><a href="#sect2"><strong>2. Datatypes</strong></a><br /><div class="tocindent"><a href="#sect2.1"><strong>2.1 TEXT</strong></a><br /><a href="#sect2.2"><strong>2.2 TAGS</strong></a><br /></div><a href="#sect3"><strong>3. Style actors</strong></a><br /><div class="tocindent"><a href="#sect3.1"><strong>3.1 ON-INIT</strong></a><br /><a href="#sect3.2"><strong>3.2 ON-SET / SET-FACE</strong></a><br /><div class="tocindent"><a href="#sect3.2.1">3.2.1 basic usage</a><br /><a href="#sect3.2.2">3.2.2 fields</a><br /></div><a href="#sect3.3"><strong>3.3 ON-GET / GET-FACE</strong></a><br /><a href="#sect3.4"><strong>3.4 ON-DRAW</strong></a><br /><a href="#sect3.5"><strong>3.5 ON-RESIZE</strong></a><br /><a href="#sect3.6"><strong>3.6 ON-FOCUS</strong></a><br /><a href="#sect3.7"><strong>3.7 ON-KEY</strong></a><br /><a href="#sect3.8"><strong>3.8 ON-REMOVE-ROW</strong></a><br /><a href="#sect3.9"><strong>3.9 ON-OPEN-EDITOR</strong></a><br /><a href="#sect3.10"><strong>3.10 ON-FIND-CELL</strong></a><br /><a href="#sect3.11"><strong>3.11 ON-FIND-COL</strong></a><br /><a href="#sect3.12"><strong>3.12 ON-SORT</strong></a><br /><a href="#sect3.13"><strong>3.13 ON-GET-COL</strong></a><br /><a href="#sect3.14"><strong>3.14 ON-FILTER-DATA</strong></a><br /><a href="#sect3.15"><strong>3.15 ON-GET-VIEW and ON-GET-FLAT-VIEW</strong></a><br /><a href="#sect3.16"><strong>3.16 ON-SCROLL-LINE</strong></a><br /><a href="#sect3.17"><strong>3.17 ON-GET-RECORD</strong></a><br /><a href="#sect3.18"><strong>3.18 ON-SET-VALUE</strong></a><br /><a href="#sect3.19"><strong>3.19 ON-INIT-TABLE</strong></a><br /><a href="#sect3.20"><strong>3.20 ON-ENTER and ON-EDIT-ACTION</strong></a><br /></div><a href="#sect4"><strong>4. Style access</strong></a><br /><div class="tocindent"><a href="#sect4.1"><strong>4.1 Get values</strong></a><br /><div class="tocindent"><a href="#sect4.1.1">4.1.1 VALUE</a><br /><a href="#sect4.1.2">4.1.2 DATA</a><br /><a href="#sect4.1.3">4.1.3 FILTERED</a><br /><a href="#sect4.1.4">4.1.4 FILTER</a><br /><a href="#sect4.1.5">4.1.5 LABELS</a><br /><a href="#sect4.1.6">4.1.6 ROW</a><br /></div><a href="#sect4.2"><strong>4.2 Set values</strong></a><br /><div class="tocindent"><a href="#sect4.2.1">4.2.1 VALUE</a><br /><a href="#sect4.2.2">4.2.2 DATA</a><br /><a href="#sect4.2.3">4.2.3 LABELS</a><br /><a href="#sect4.2.4">4.2.4 FILTER</a><br /></div></div><a href="#sect5"><strong>5. Text-Table Data</strong></a><br /><div class="tocindent"><a href="#sect5.1"><strong>5.1 Specifying which columns to show</strong></a><br /></div><a href="#sect6"><strong>6. Filters</strong></a><br /><div class="tocindent"><a href="#sect6.1"><strong>6.1 Access row data for filtered list</strong></a><br /></div></div><p>TEXT-TABLE style provides table that can be used for displaying database data etc. Each column of the table provides support for sorting and filtering data, can be assigned to different column of the source data, the source data can be referenced so all changes will be reflected in the table with simple update call. All table functions can be executed from GUI all called programatically.</p><h2><a id="sect1" name="sect1">1. Dialect specification</a></h2><pre class="example">TEXT-TABLE init-size [pair!] list-options [block!] list-data [block!]</pre><h3><a id="sect1.1" name="sect1.1">1.1 init-size</a></h3><p>Init size specifies table's size.</p><h3><a id="sect1.2" name="sect1.2">1.2 list-options</a></h3><p>List-options specify columns settings. List-options contain one or more labels, each label can have width and column index specified. You can also specify datatype for each column.</p><pre class="example">column-name [string!] column-index [issue!] column-width [integer!] datatype [word!]

Example: [&quot;First name&quot; #1 250 &quot;Surname&quot; #2 300 &quot;Age&quot; #4 50 number] </pre><p>If index is not specified, columns are automatically enumerated from 1 up. If width is not specified, default value of 150px is used. Datatype specifies datatype used in column. These datatypes are not same as REBOL datatypes, they are adjust for use with TEXT-TABLE (see below).</p><h3><a id="sect1.3" name="sect1.3">1.3 list-data</a></h3><p>List-data are actual data used for displaying. They can be referenced. If referenced data are changed, UPDATE-FACE TEXT-TABLE must be called to reflect changes.</p><p>Format of list-data is block of blocks, where each block is one row. Rows can have different length.</p><pre class="example">Example: [
    [&quot;John&quot; &quot;Doe&quot; NY 45]
    [&quot;Erica&quot; &quot;Stone&quot; CA 19 none &quot;note 1&quot;]
    [&quot;James&quot; &quot;Cole&quot; FL 5 &quot;note 2&quot;]
]</pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect2" name="sect2">2. Datatypes</a></h2><p>TEXT-TABLE supports different datatypes as values. They are not same as REBOL datatypes, although most of them share same name. There are some special datatypes like TAGS not found in REBOL. If no datatype is specified, TEXT is used. Datatypes speciefies which editor to open, or which validator to use.</p><p>Currently supported datatypes are:</p><h3><a id="sect2.1" name="sect2.1">2.1 TEXT</a></h3><p>Basic datatype used for all values that haven't speciefied different datatype. TEXT opens standard field as an editor.</p><h3><a id="sect2.2" name="sect2.2">2.2 TAGS</a></h3><p>TAGS are stored as string! values in a block!. TAGS type opens tag editor.</p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect3" name="sect3">3. Style actors</a></h2><p>Actors are the API of R3GUI. TEXT-TABLE uses some standard actors and also adds some custom actors to support all TEXT-TABLE functions. Currently implemented actors are:</p><h3><a id="sect3.1" name="sect3.1">3.1 ON-INIT</a></h3><p>Basic internal actor used when initializing GUI. Style user doesn't need to access this actor.</p><h3><a id="sect3.2" name="sect3.2">3.2 ON-SET / SET-FACE</a></h3><p>Basic actor used for setting table's values. There are several ways to set data, preffered way is to use SET-FACE function which calls the ON-SET actor. It's also possible to use ON-SET actor directly, but this will omit some data checks etc.</p><h4><a id="sect3.2.1" name="sect3.2.1">3.2.1 basic usage</a></h4><pre class="example">SET-FACE text-table active-row </pre><p>Basic usage that will set active row (NOTE: this may change).</p><h4><a id="sect3.2.2" name="sect3.2.2">3.2.2 fields</a></h4><p>Because TEXT-TABLE is complex style with lots of different data, additional ways to input these data are implemented using the /fields refinement. Follows the list of all supported fields.</p><p><strong>VALUE</strong></p><p>Basic field, works same as if no field is specified.</p><p><strong>DATA</strong></p><p>Set table's data. Usage:</p><pre class="example">SET-FACE/FIELD text-table table-data 'data </pre><p><strong>LABELS</strong></p><p>(NOTE: name of this field will change to better describe fuctionality.)</p><p>Set table's attributes. Usage:</p><pre class="example">SET-FACE/FIELD text-table attributes 'labels

SET-FACE/FIELD text-table attributes 'atts ; proposed change of field name</pre><p>For the dialect description, see above the LIST-OPTIONS.</p><p><strong>STATE</strong></p><p>Set table's state. State is object holding current table state (active filters, sorting, active row...). This state can be stored on disk for later use.</p><h3><a id="sect3.3" name="sect3.3">3.3 ON-GET / GET-FACE</a></h3><p>Basic actor and function for getting table's values. Preffered method is to use GET-FACE function, it's also possible to get values using ON-GET actor.</p><pre class="example">GET-FACE text-table </pre><p>Will return active row number.</p><p>Basic actor</p><h3><a id="sect3.4" name="sect3.4">3.4 ON-DRAW</a></h3><p>Basic internal actor that handles drawing of table data. ON-DRAW calls ON-DRAW-GRID which draws table's header and grid. After that, ON-DRAW-ROW is called for each visible row that calls ON-DRAW-CELL to draw each cell. All actors add draw code to the LAYOUT-BLOCK facet.</p><h3><a id="sect3.5" name="sect3.5">3.5 ON-RESIZE</a></h3><p>Basic actor handling resizing code.</p><h3><a id="sect3.6" name="sect3.6">3.6 ON-FOCUS</a></h3><p>Basic actor handling focusing code.</p><h3><a id="sect3.7" name="sect3.7">3.7 ON-KEY</a></h3><p>Basic actor handling keyboard bindings. See below for list of supported keys.</p><h3><a id="sect3.8" name="sect3.8">3.8 ON-REMOVE-ROW</a></h3><p>ARG: row index to remove.</p><p>Remove row from table data.</p><h3><a id="sect3.9" name="sect3.9">3.9 ON-OPEN-EDITOR</a></h3><p>INTERNAL actor. Will open data editor of selected type. Uses ON-PLACE-EDITOR internal actor to determine editor placement.</p><h3><a id="sect3.10" name="sect3.10">3.10 ON-FIND-CELL</a></h3><p>ARG: Y position in pixels.</p><p>Return index of row under mouse cursor.</p><h3><a id="sect3.11" name="sect3.11">3.11 ON-FIND-COL</a></h3><p>ARG: X position in pixels</p><p>Return index of column under mouse cursor.</p><h3><a id="sect3.12" name="sect3.12">3.12 ON-SORT</a></h3><p>ARG: column index [integer!], direction [UP DOWN anything-else]</p><p>Will sort table data. ON-SORT creates sorted index, original data are not changed.User can select by which column to sort and the direction of sort. Sort support |UP and DOWN directions, anything else (NONE is prefered but not required) will change the sorting index back to unsorted data.</p><h3><a id="sect3.13" name="sect3.13">3.13 ON-GET-COL</a></h3><p>ARG: visible index</p><p>Return index in data (Columns can be rearanged and ie. third visible column can be second in source data. This function will change visible index to real one).</p><h3><a id="sect3.14" name="sect3.14">3.14 ON-FILTER-DATA</a></h3><p>ARG: NONE (turn off filtering) or [column-index [integer!] filter [block!]]</p><p>TODO: support multi-filters (filter with more than one column).</p><p>Will filter data according to a filter. Binds VALUE for filter which is cell's value that can be tested against filter.</p><p>Example: all values starting with &quot;A&quot;:</p><pre class="example">all [
    not none? value
    value/1 = #&quot;a&quot;
] </pre><h3><a id="sect3.15" name="sect3.15">3.15 ON-GET-VIEW and ON-GET-FLAT-VIEW</a></h3><p>ARG: block of indexes</p><p>Return filtered view of table. NOTE: ON-GET-FLAT-VIEW actor will be removed soon.</p><h3><a id="sect3.16" name="sect3.16">3.16 ON-SCROLL-LINE</a></h3><p>ARG: number of lines to scroll [integer!] - positive: scroll down, negative: scroll up</p><p>Scroll table view by required number of lines.</p><h3><a id="sect3.17" name="sect3.17">3.17 ON-GET-RECORD</a></h3><p>ARG: record id [integer!]</p><p>Return value from table.</p><h3><a id="sect3.18" name="sect3.18">3.18 ON-SET-VALUE</a></h3><p>ARG: value</p><p>Will set value. NOTE: Value differs in TEXT-TABLE and TEXT-LIST, this actor hadles the differencies.</p><h3><a id="sect3.19" name="sect3.19">3.19 ON-INIT-TABLE</a></h3><p>Used by DB handler to clear table all indexes.</p><h3><a id="sect3.20" name="sect3.20">3.20 ON-ENTER and ON-EDIT-ACTION</a></h3><p>Actor is called when value is set in editor.</p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect4" name="sect4">4. Style access</a></h2><h3><a id="sect4.1" name="sect4.1">4.1 Get values</a></h3><h4><a id="sect4.1.1" name="sect4.1.1">4.1.1 VALUE</a></h4><p><strong>integer!</strong></p><p>Returns index of current value in list-data.</p><h4><a id="sect4.1.2" name="sect4.1.2">4.1.2 DATA</a></h4><p><strong>block!</strong></p><p>Returns list-data.</p><h4><a id="sect4.1.3" name="sect4.1.3">4.1.3 FILTERED</a></h4><p><strong>block!</strong></p><p>Returns filtered list-data.</p><h4><a id="sect4.1.4" name="sect4.1.4">4.1.4 FILTER</a></h4><p><strong>block!</strong></p><p>Returns current filter settings.</p><h4><a id="sect4.1.5" name="sect4.1.5">4.1.5 LABELS</a></h4><p><strong>block!</strong></p><p>Returns current settings of labels in list-labels format (see above).</p><h4><a id="sect4.1.6" name="sect4.1.6">4.1.6 ROW</a></h4><p><strong>block!</strong></p><p>Returns list-data at current row position.</p><h3><a id="sect4.2" name="sect4.2">4.2 Set values</a></h3><h4><a id="sect4.2.1" name="sect4.2.1">4.2.1 VALUE</a></h4><p><strong>integer</strong></p><p>Set index (highlight row) of list-data.</p><h4><a id="sect4.2.2" name="sect4.2.2">4.2.2 DATA</a></h4><p>Set data for table.</p><h4><a id="sect4.2.3" name="sect4.2.3">4.2.3 LABELS</a></h4><p>Set column labels.</p><h4><a id="sect4.2.4" name="sect4.2.4">4.2.4 FILTER</a></h4><p>Set filter to use.</p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect5" name="sect5">5. Text-Table Data</a></h2><h3><a id="sect5.1" name="sect5.1">5.1 Specifying which columns to show</a></h3><p>This will show columns 2-4 but not column 1 from text-table-data</p><pre class="example">text-table [&quot;State&quot; #2 &quot;Item&quot; #3 &quot;Touched&quot; #4] text-table-data</pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect6" name="sect6">6. Filters</a></h2><h3><a id="sect6.1" name="sect6.1">6.1 Access row data for filtered list</a></h3><p>TEXT-TABLE/FACETS/FILTERED contains just the filtered rows.</p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><p class="end">Document formatter copyright <a href="http://www.robertmuench.de">Robert M. M&uuml;nch</a>. All Rights Reserved.<br />XHTML 1.0 Transitional formatted with Make-Doc-Pro Version:1.3.0 on 23-Jan-2012 at 15:27:20</p></body></html>